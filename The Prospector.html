<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1">
    <title>The Prospector — Keep Talking and Nobody Explodes Module</title>
    <link rel="stylesheet" type="text/css" href="css/font.css" />
    <link rel="stylesheet" type="text/css" href="css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="css/main.css" />
    <script src="js/ktane-utils.js"></script>
    <script src="js/ruleseed.js"></script>

    <script>
        const DEFAULT_SIGILS = [
            "Mighty Leap",
            "Many Lives",
            "Touch of Death",
            "Stinky",
            "Sprinter",
        ];

        const RULE_SEEDED_SIGILS = [
            "Airborne",
            "Amorphous",
            "Ant Spawner",
            "Bees Within",
            "Bellist",
            "Bifurcated Strike",
            "Bone King",
            "Burrower",
            "Corpse Eater",
            "Dam Builder",
            "Fecundity",
            "Fledgling",
            "Guardian",
            "Hefty",
            "Hoarder",
            "Leader",
            "Loose Tail",
            "Rabbit Hole",
            "Sharp Quills",
            "Trifurcated Strike",
            "Trinket Bearer",
            "Unkillable",
            "Waterborne",
            "Worthy Sacrifice",
        ];

        const SIGILS_COUNT_TO_PICK = 11;

        const TABLED_INSECTS = [
            "Amalgam",
            "Ant Queen",
            "Bee",
            "Beehive",
            "Cockroach",
            "Corpse Maggots",
            "Mantis",
            "Mantis God",
            "Strange Larva",
            "Strange Pupa",
            "Ring Worm",
            "Stinkbug",
            "Worker Ant",
        ];

        function setDefaultRules(rnd) { setRules(rnd); }
        function setRules(rnd) {
            const sigils = [...DEFAULT_SIGILS, ...rnd.shuffleArray(RULE_SEEDED_SIGILS)].slice(0, SIGILS_COUNT_TO_PICK);
            const table = document.getElementById("table");
            while (table.children.length > 2) table.removeChild(table.lastChild);
            let splitTable = true;
            for (const sigil of sigils) {
                const row = table.appendChild(document.createElement("tr"));
                if (splitTable) {
                    row.classList.add("table-split");
                    splitTable = false;
                }
                const sigilTd = row.appendChild(document.createElement("td"));
                sigilTd.classList.add("black-bg");
                const img = sigilTd.appendChild(document.createElement("img"));
                img.src = `img/The Prospector/Sigils/${sigil}.png`;
                img.title = sigil;
                for (let i = 0; i < 10; i++) {
                    const td = row.appendChild(document.createElement("td"));
                    if (rnd.nextDouble() < 0.5) td.innerText = rnd.nextMax(10);
                    else if (rnd.nextDouble() < 0.1) td.innerText = ["B", "A", "D", "H"][rnd.nextMax(4)];
                    else {
                        const char = ["B", "A", "D", "H"][rnd.nextMax(4)];
                        const operation = ["+", "-", "*"][rnd.nextMax(3)];
                        const num = operation === "*" ? [3, 7, 9][rnd.nextMax(3)] : rnd.nextMax(9) + 1;
                        td.innerText = rnd.nextDouble() < 0.5 ? `${char}${operation}${num}` : `${num}${operation}${char}`;
                    }
                }
            }
            splitTable = true;
            for (const insect of TABLED_INSECTS) {
                const row = table.appendChild(document.createElement("tr"));
                if (splitTable) {
                    row.classList.add("table-split");
                    splitTable = false;
                }
                const nameTd = row.appendChild(document.createElement("td"));
                const nameDiv = nameTd.appendChild(document.createElement("div"));
                nameDiv.classList.add("card-name");
                nameDiv.innerText = insect;
                const values = rnd.shuffleArray([..."LLLRRRMMM" + "LRM"[rnd.nextMax(3)]]);
                for (let i = 0; i < 10; i++) {
                    const td = row.appendChild(document.createElement("td"));
                    td.innerText = values[i];
                }
            }
        }
    </script>

    <style>
        .black-bg {
            background-color: #391c06;
        }

        p {
            font-size: 15px;
        }

        table {
            margin: auto;
            font-size: 14px;
        }

        #table img {
            width: 32px;
            height: 32px;
        }

        #table td {
            text-align: center;
        }

        #table tr:not(:first-child):not(:nth-child(2)) td:not(:first-child) {
            width: 32px;
        }

        .card-name {
            display: inline;
            font-size: 1.1em;
            line-height: 0.9em;
            vertical-align: -0.1em;
            font-family: 'Heavy Wei', 'Special Elite', 'Courier New', monospace;
            font-style: normal;
        }

        .page-header-section-title.card-name {
            margin-top: 12px;
            font-size: 1.3em;
        }

        .red {
            color: maroon;
        }

        .table-split > td {
            border-top-width: 3px;
        }
    </style>
</head>

<body>
    <div class="section">
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title card-name"><span class="card-name">The Prospector</span></span>
            </div>
            <div class="page-content">
                <img src="img/Component/The Prospector.svg" class="diagram">
                <h2>On the Subject of <span class="card-name">The Prospector</span></h2>
                <p class="flavour-text">
                    Care for a game of chance? Pick <span class="card-name">Builder</span> and I'll break it.<br />
                    If it's <span class="card-name">Gold Nugget</span>... it's yours.
                </p>
                <p>
                    The module has three <span class="card-name">Builder</span>s. There is <span class="card-name">Gold Nugget</span> under one of them.
                    Press <span class="card-name">Builder</span> to strike it.
                    If there is <span class="card-name">Gold Nugget</span>, press it to solve the module.
                </p>
                <p>
                    On top of the module is a cell where the last found insect card is placed.
                    If it is empty, then there are insects under the two <span class="card-name">Builder</span>s.
                    If there is no <span class="card-name">Gold Nugget</span> under the striked <span class="card-name">Builder</span>,
                    then the found insect will move to this cell.
                </p>
                <p>
                    If there is an insect in this cell, then there is a <span class="card-name">Leaping Trap</span> under one of <span class="card-name">Builder</span>.
                    If you hit this <span class="card-name">Builder</span>, the <span class="card-name">Leaping Trap</span> will kill the insect and give you a strike.
                    If you strike <span class="card-name">Builder</span> under which an insect is located, this new insect will replace the current one.
                </p>
                <p>
                    If you strike <span class="card-name">Boulder</span>, under which there is no <span class="card-name">Gold Nugget</span>,
                    then new <span class="card-name">Builder</span>s will appear when another module is solved.
                    If there are no other unsolved modules,
                    then new <span class="card-name">Builder</span>s will appear immediately, and <span class="card-name">Gold Nugget</span> will be located under two of them.
                    If another module is solved, and none of <span class="card-name">Builder</span>s are striked,
                    then <span class="card-name">The Prospector</span> will hit a random <span class="card-name">Boulder</span> itself after thirty seconds
                    if you do not do it before him.
                </p>
                <p>
                    Each insect that can be found under <span class="card-name">Builder</span>s has one additional sigil. It is sewn to the card and has a black background.
                    Find the row with this sigil in the table below and get the value located in the column with the first digit of the serial number.
                    If the value contains a letter, then convert it to the number (B - batteries, A - AA-batteries, D - D-batteries, H - battery holders).
                    Bring the value into the range from zero to nine by adding or subtracting 10.
                    Using the value as a column, and the name of the card as a row,
                    get under what <span class="card-name">Boulder</span> is <span class="card-name">Leaping Trap</span> located (L - left, R - right, M - middle).
                </p>
                <p style="margin-bottom: 0;">Special cards:</p>
                <ul style="margin-top: 0;">
                    <li>
                        <span class="card-name red">Mantis God</span>: <span class="card-name">Leaping Trap</span> replaced with <span class="card-name">Gold Nugget</span>
                    </li>
                    <li><span class="card-name red">Amalgam</span>: Use sigil of this card for next insect</li>
                    <li>
                        <span class="card-name red">Strange Larva</span>: <span class="card-name">Gold Nugget</span> is removed.
                        <span class="card-name">The Prospector</span> will not strike <span class="card-name">Boulder</span>s.<br>
                        If it will not killed, the next insect will be <span class="card-name">Strange Pupa</span>
                    </li>
                    <li>
                        <span class="card-name red">Strange Pupa</span>: <span class="card-name">Gold Nugget</span> is removed.
                        <span class="card-name">The Prospector</span> will not strike <span class="card-name">Boulder</span>s.<br>
                        If it will not killed, the next insect will be <span class="card-name">Mothman</span>
                    </li>
                    <li><span class="card-name red">Mothman</span>: All <span class="card-name">Boulder</span>s are <span class="card-name">Gold Nugget</span></li>
                    <li><span class="card-name red">Ant Queen</span>: If it will not killed, the next insect will be <span class="card-name">Worker Ant</span></li>
                    <li>
                        <span class="card-name red">Worker Ant</span> & <span class="card-name red">Ant Queen</span>:
                        If the previous insect was <span class="card-name">Worker Ant</span> or <span class="card-name">Ant Queen</span>,
                        then <span class="card-name">Leaping Trap</span> replaced with <span class="card-name">Gold Nugget</span>
                        and all <span class="card-name">Boulder</span>s are shuffled
                    </li>
                </ul>
            </div>
            <div class="page-footer relative-footer">Page 1 of 2</div>
        </div>
        <div class="page page-bg-02">
            <div class="page-header">
                <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                <span class="page-header-section-title card-name">The Prospector</span>
            </div>
            <div class="page-content">
                <table>
                    <tbody id="table">
                        <tr>
                            <td rowspan="2">Sigil /<br>Card name</td>
                            <td colspan="10">First digit of the serial number / Obtained value</td>
                        </tr>
                        <tr>
                            <td>0</td>
                            <td>1</td>
                            <td>2</td>
                            <td>3</td>
                            <td>4</td>
                            <td>5</td>
                            <td>6</td>
                            <td>7</td>
                            <td>8</td>
                            <td>9</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="page-footer relative-footer">Page 2 of 2</div>
        </div>
    </div>
</body>

</html>
